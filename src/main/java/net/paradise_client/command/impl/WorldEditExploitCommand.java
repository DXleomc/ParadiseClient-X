package net.paradise_client.command.impl;

import com.mojang.brigadier.arguments.IntegerArgumentType;
import com.mojang.brigadier.arguments.StringArgumentType;
import com.mojang.brigadier.builder.LiteralArgumentBuilder;
import com.mojang.brigadier.suggestion.Suggestions;
import com.mojang.brigadier.suggestion.SuggestionsBuilder;
import net.minecraft.command.CommandSource;
import net.paradise_client.command.Command;
import net.paradise_client.exploit.impl.WorldEditExploit;
import java.util.concurrent.CompletableFuture;

public class WorldEditExploitCommand extends Command {

    public WorldEditExploitCommand() {
        super("worldeditexploit", "Crashes servers with WorldEdit", true);
    }

    @Override
    public void build(LiteralArgumentBuilder<CommandSource> root) {
        root.then(argument("power", IntegerArgumentType.integer(1))
                .then(argument("mode", StringArgumentType.word())
                        .suggests(this::modeSuggestions)
                        .executes(context -> {
                            int power = IntegerArgumentType.getInteger(context, "power");
                            String mode = StringArgumentType.getString(context, "mode");
                            WorldEditExploit.execute(power, mode);
                            return SINGLE_SUCCESS;
                        })));
    }

    private CompletableFuture<Suggestions> modeSuggestions(com.mojang.brigadier.context.CommandContext<CommandSource> context, SuggestionsBuilder builder) {
        builder.suggest("new");
        builder.suggest("old");
        return builder.buildFuture();
    }
}
